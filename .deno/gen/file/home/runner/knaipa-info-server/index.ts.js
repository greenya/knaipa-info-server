import { Application, BadRequestException } from 'https://deno.land/x/abc/mod.ts';
import * as bnapi from 'https://deno.land/x/bnapi/mod.ts';
import { Cache } from './cache.ts';
import * as extra from './extra.ts';
import * as loc from './loc.ts';
const appBootedAt = Date.now();
const cache = new Cache();
cache.add('auth', async () => await bnapi.auth(Deno.env.get('BNAPI_KEY'), Deno.env.get('BNAPI_SECRET'), 'eu', 'en_GB'), {
    expMinutes: 23 * 60,
    expFuzzyPercent: 0
});
cache.add('races', async () => {
    const races = (await bnapi.wow.playableRaces()).map(e => ({
        id: e.id,
        name: e.name
    }));
    return races;
}, { expMinutes: -1 });
cache.add('classes', async () => {
    const classes = (await bnapi.wow.playableClasses()).map(e => ({
        id: e.id,
        name: e.name
    }));
    for (let i = 0; i < classes.length; i++) {
        const c = await bnapi.wow.playableClass(classes[i].id);
        classes[i].specs = c.specializations.map(e => e.id);
        classes[i].power = c.power_type.id;
        classes[i].media = (await bnapi.wow.playableClassMedia(c.media.id)).assets[0].value;
        if (c.id == 12) {
            classes[i].media = 'https://render-eu.worldofwarcraft.com/icons/56/classicon_demonhunter.jpg';
        }
    }
    return classes;
}, { expMinutes: -1 });
cache.add('specs', async () => {
    const specs = (await bnapi.wow.playableSpecializations()).character_specializations.map(e => ({
        id: e.id,
        name: e.name
    }));
    for (let i = 0; i < specs.length; i++) {
        const c = await bnapi.wow.playableSpecialization(specs[i].id);
        specs[i].role = c.role.type;
        specs[i].media = (await bnapi.wow.playableSpecializationMedia(c.media.id)).assets[0].value;
    }
    return specs;
}, { expMinutes: -1 });
async function getRecipe(id, name, tierId, cat) {
    const recipe = {
        id,
        name,
        tier: tierId,
        cat
    };
    const rec = await bnapi.wow.recipe(id);
    if (rec) {
        recipe.rank = rec.rank;
        const crafted = rec.alliance_crafted_item || rec.crafted_item;
        if (crafted) {
            const media = await bnapi.wow.itemMedia(crafted.id);
            recipe.item = {
                id: crafted.id,
                name: crafted.name,
                media: media?.assets?.shift()?.value,
                min: rec.crafted_quantity.value || rec.crafted_quantity.minimum,
                max: rec.crafted_quantity.value || rec.crafted_quantity.maximum
            };
        }
        if (!recipe.item || !recipe.item.media) {
            const media = await bnapi.wow.recipeMedia(rec.media.id);
            recipe.media = media?.assets?.shift()?.value;
        }
    }
    return recipe;
}
cache.add('professions', async () => {
    const result = {
        professions: [],
        recipes: [],
        recipeSearchIdx: '',
        recipeSearchPos: []
    };
    console.log('Updating professions...');
    for (const { id: profId } of await bnapi.wow.professions()) {
        const prof = await bnapi.wow.profession(profId);
        const media = await bnapi.wow.professionMedia(prof.media.id);
        const profession = {
            id: profId,
            name: prof.name,
            type: prof.type.type,
            tiers: [],
            media: media?.assets[0].value
        };
        for (const skillTier of prof.skill_tiers || []) {
            const tier = { id: skillTier.id, name: skillTier.name, cats: [] };
            profession.tiers.push(tier);
            const { categories } = await bnapi.wow.professionSkillTier(profId, tier.id);
            for (const { recipes, name: catName } of categories || []) {
                const cat = tier.cats.push(catName) - 1;
                for (const { id, name } of recipes) {
                    if (name.includes('|')) {
                        console.log('Recipe name has special characters and will be skipped:', id, name);
                    }
                    else {
                        const recipe = await getRecipe(id, name, tier.id, cat);
                        result.recipes.push(recipe);
                    }
                }
                console.log('Current recipes count:', result.recipes.length);
                await new Promise(r => setTimeout(r, 1000));
            }
        }
        result.professions.push(profession);
    }
    console.log('Building recipe search index...');
    result.recipes.sort((a, b) => a.name.toLocaleLowerCase().localeCompare(b.name.toLocaleLowerCase()));
    result.recipeSearchIdx = '|';
    for (let i = 0; i < result.recipes.length; i++) {
        result.recipeSearchPos.push(result.recipeSearchIdx.length);
        result.recipeSearchIdx += result.recipes[i].name.toLowerCase() + '|';
    }
    return result;
}, { expMinutes: -1 });
async function updateCharProfile(name, realm) {
    const profile = await bnapi.wow.characterProfile(realm, name);
    if (profile && profile.guild && profile.guild.id == 65456969) {
        const media = await bnapi.wow.characterMediaAssets(realm, name);
        return {
            spec: profile.active_spec.id,
            login: profile.last_login_timestamp,
            avatar: media?.find(e => e.key == 'avatar')?.value,
            inset: media?.find(e => e.key == 'inset')?.value,
            main: media?.find(e => e.key == 'main')?.value,
            mainRaw: media?.find(e => e.key == 'main-raw')?.value,
            gender: profile.gender.type,
            exp: profile.experience,
            title: profile.active_title?.display_string,
            achiPoints: profile.achievement_points,
            avgILvl: profile.average_item_level,
            equILvl: profile.equipped_item_level,
            covenant: profile.covenant_progress?.chosen_covenant.id,
            renown: profile.covenant_progress?.renown_level
        };
    }
    else {
        throw new Error(`ðŸ›‘ Failed to update profile: ${name} (${realm})`);
    }
}
async function updateCharStats(name, realm) {
    const stats = await bnapi.wow.characterAchievementStatistics(realm, name);
    if (!stats) {
        return {};
    }
    const arr = stats.reduce((a, c) => {
        a = [...a, ...(c.statistics || []), ...(c.sub_categories ? c.sub_categories.reduce((a, c) => {
                a = [...a, ...(c.statistics || [])];
                return a;
            }, []) : [])];
        return a;
    }, []);
    return arr
        .sort((a, b) => a.id - b.id)
        .reduce((a, c) => {
        a[c.id] = c.quantity;
        return a;
    }, {});
}
async function updateCharProfessions(name, realm) {
    const result = {
        professions: [],
        recipes: []
    };
    const profs = await bnapi.wow.characterProfessions(realm, name);
    for (const { profession, tiers } of [...(profs.primaries || []), ...(profs.secondaries || [])]) {
        result.professions.push(profession.id);
        for (const { known_recipes: recipes } of tiers || []) {
            for (const { id } of recipes || []) {
                result.recipes.push(id);
            }
        }
    }
    return result;
}
cache.add('roster', async () => {
    const members = await bnapi.wow.guildRoster('terokkar', 'knaipa-variativ');
    const maxLevelMembers = members.filter(e => e.character.level == 60);
    for (let i = 0; i < maxLevelMembers.length; i++) {
        const m = maxLevelMembers[i];
        const name = m.character.name;
        const realm = m.character.realm.slug;
        const profileKey = `char-profile-${name}-${realm}`.toLowerCase();
        if (!cache.has(profileKey)) {
            cache.add(profileKey, () => updateCharProfile(name, realm), { expMinutes: 30 });
            cache.add(`char-stats-${name}-${realm}`.toLowerCase(), () => updateCharStats(name, realm), { expMinutes: 40 });
            cache.add(`char-professions-${name}-${realm}`.toLowerCase(), () => updateCharProfessions(name, realm), { expMinutes: 50 });
        }
    }
    return maxLevelMembers.map(e => ({
        slug: `${e.character.name}-${e.character.realm.slug}`.toLocaleLowerCase(),
        name: e.character.name,
        realm: e.character.realm.slug,
        level: e.character.level,
        race: e.character.playable_race.id,
        class: e.character.playable_class.id,
        rank: e.rank > 0 ? e.rank : 1
    }));
}, { expMinutes: 10 });
await cache.update('auth');
await cache.update('roster');
await cache.load();
cache.live();
function searchRecipe(text, cursor = 0) {
    text = text.trim().toLowerCase();
    if (text.length < 2) {
        throw new BadRequestException('Search text too short');
    }
    const professions = cache.get('professions');
    const roster = cache.get('roster') || [];
    const results = [];
    while (cursor >= 0 && results.length < 50) {
        cursor = professions.recipeSearchIdx.indexOf(text, cursor);
        if (cursor >= 0) {
            const pipe = professions.recipeSearchIdx.lastIndexOf('|', cursor - 1);
            const idx = professions.recipeSearchPos.indexOf(pipe + 1);
            const recipe = professions.recipes[idx];
            const crafters = [];
            for (const { slug } of roster) {
                const charProfs = cache.get('char-professions-' + slug);
                if (charProfs && charProfs.recipes.includes(recipe.id)) {
                    const charProfile = cache.get('char-profile-' + slug);
                    crafters.push({
                        slug,
                        login: charProfile ? charProfile.login : 0
                    });
                }
            }
            results.push({
                id: recipe.id,
                name: recipe.name,
                tier: recipe.tier,
                cat: recipe.cat,
                rank: recipe.rank,
                item: recipe.item,
                media: recipe.media,
                crafters: crafters.sort((a, b) => b.login - a.login).map(c => c.slug)
            });
            cursor++;
        }
    }
    return { results, text, cursor };
}
function calculateRanking(values, prop) {
    const ranking = [];
    values.sort((a, b) => (b[prop] || 0) - (a[prop] || 0) || a.slug.localeCompare(b.slug));
    for (let j = -1, i = 0; i < values.length; i++) {
        if (j == -1 || ranking[j].value != values[i][prop]) {
            j++;
            if (j == 10) {
                break;
            }
            ranking.push({
                rank: j + 1,
                chars: [values[i].slug],
                value: values[i][prop]
            });
        }
        else {
            ranking[j].chars.push(values[i].slug);
        }
    }
    return ranking;
}
function generateRankings() {
    const roster = cache.get('roster') || [];
    const rosterWithoutAlts = roster.filter(e => e.rank != 5);
    const stats = roster.map(({ slug }) => {
        const stat = cache.get('char-stats-' + slug);
        return { slug, ...stat };
    });
    const statsWithoutAlts = rosterWithoutAlts.map(({ slug }) => {
        const stat = cache.get('char-stats-' + slug);
        return { slug, ...stat };
    });
    const ranks = extra.ranks().map(rank => {
        let values = [];
        let valueKey = 0;
        if (rank.id == extra.RankId.AchievementPoints) {
            values = rosterWithoutAlts.map(({ slug }) => {
                const profile = cache.get('char-profile-' + slug);
                return { slug, achiPoints: profile?.achiPoints || 0 };
            });
            valueKey = 'achiPoints';
        }
        if (rank.id == extra.RankId.ItemLevel) {
            values = roster.map(({ slug }) => {
                const profile = cache.get('char-profile-' + slug);
                return { slug, equILvl: profile?.equILvl || 0 };
            });
            valueKey = 'equILvl';
        }
        if (rank.id == extra.RankId.RecipesKnown) {
            values = roster.map(({ slug }) => {
                const prof = cache.get('char-professions-' + slug);
                return { slug, count: prof?.recipes.length || 0 };
            });
            valueKey = 'count';
        }
        if (rank.statId) {
            values = rank.statAccountWide ? statsWithoutAlts : stats;
            valueKey = rank.statId;
        }
        return {
            icon: rank.icon,
            name: rank.name,
            desc: rank.desc,
            ranking: calculateRanking(values, valueKey)
        };
    });
    return ranks;
}
const appPort = 8080;
const appStartedAt = Date.now();
const app = new Application();
app.get('/info', () => ({
    uptime: Math.ceil((Date.now() - appStartedAt) / 1000),
    boottime: (appStartedAt - appBootedAt) / 1000,
    ...cache.info()
}));
app.get('/live', () => cache.live());
app.get('/die', () => cache.die());
app.get('/reset/:key', c => cache.reset(c.params.key));
app.get('/races', () => cache.get('races').map(r => ({
    ...r,
    loc: loc.race(r.id)
})).filter(r => r.loc));
app.get('/classes', () => cache.get('classes').map(c => ({
    ...c,
    loc: loc.clazz(c.id)
})));
app.get('/specs', () => cache.get('specs'));
app.get('/professions', () => cache.get('professions').professions.map(p => ({
    ...p,
    tiers: p.tiers.map(t => ({
        ...t,
        cats: t.cats.map(c => ({
            name: c,
            loc: loc.text(c)
        })),
        loc: loc.professionTier(t.id)
    })),
    loc: loc.profession(p.id)
})));
app.get('/roster', () => cache.get('roster'));
app.get('/char/:char', c => {
    const key = 'char-profile-' + decodeURIComponent(c.params.char).toLowerCase();
    const { spec, login, avatar, inset } = cache.get(key);
    return {
        spec,
        login,
        avatar,
        inset
    };
});
app.get('/rankings', () => {
    try {
        console.time();
        return generateRankings();
    }
    finally {
        console.timeEnd();
    }
});
app.get('/shadowlands-legendary-recipes', () => extra.shadowlandsLegendaryRecipes());
app.get('/search-recipe', c => {
    try {
        const text = c.url.searchParams.get('text') || '';
        const cursor = parseInt(c.url.searchParams.get('cursor') || '0') || 0;
        console.log(`Search recipe containing "${text}" from ${cursor}`);
        console.time();
        return searchRecipe(text, cursor);
    }
    finally {
        console.timeEnd();
    }
});
app.pre(next => c => {
    console.log(`${c.method} ${decodeURIComponent(c.path)}`);
    c.response.headers.set('Access-Control-Allow-Origin', '*');
    return next(c);
});
app.start({ port: appPort });
console.log(`Running server http://localhost:${appPort}/... ðŸ¦•`);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsV0FBVyxFQUFFLG1CQUFtQixFQUFFLE1BQU0sZ0NBQWdDLENBQUE7QUFDakYsT0FBTyxLQUFLLEtBQUssTUFBTSxrQ0FBa0MsQ0FBQTtBQUN6RCxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sWUFBWSxDQUFBO0FBQ2xDLE9BQU8sS0FBSyxLQUFLLE1BQU0sWUFBWSxDQUFBO0FBQ25DLE9BQU8sS0FBSyxHQUFHLE1BQU0sVUFBVSxDQUFBO0FBSS9CLE1BQU0sV0FBVyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQTtBQUU5QixNQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssRUFBRSxDQUFBO0FBRXpCLEtBQUssQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEtBQUssSUFBSSxFQUFFLENBQUMsTUFBTSxLQUFLLENBQUMsSUFBSSxDQUMxQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUUsRUFDMUIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFFLEVBQzdCLElBQUksRUFDSixPQUFPLENBQ1YsRUFBRTtJQUNDLFVBQVUsRUFBRSxFQUFFLEdBQUcsRUFBRTtJQUNuQixlQUFlLEVBQUUsQ0FBQztDQUNyQixDQUFDLENBQUE7QUFPRixLQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxLQUFLLElBQXFCLEVBQUU7SUFDM0MsTUFBTSxLQUFLLEdBQVcsQ0FBQyxNQUFNLEtBQUssQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzlELEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRTtRQUNSLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSTtLQUNmLENBQUMsQ0FBQyxDQUFBO0lBRUgsT0FBTyxL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SUFBSSxDQUFDO0lBQ3JELFFBQVEsRUFBRSxDQUFDLFlBQVksR0FBRyxXQUFXLENBQUMsR0FBRyxJQUFJO0lBQzdDLEdBQUcsS0FBSyxDQUFDLElBQUksRUFBRTtDQUNsQixDQUFDLENBQUMsQ0FBQTtBQUVILEdBQUcsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFBO0FBQ3BDLEdBQUcsQ0FBQyxHQUFHLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFBO0FBQ2xDLEdBQUcsQ0FBQyxHQUFHLENBQUMsYUFBYSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7QUFFdEQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBUyxPQUFPLENBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzFELEdBQUcsQ0FBQztJQUNKLEdBQUcsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7Q0FDdEIsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUE7QUFFdkIsR0FBRyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsR0FBRyxFQUFFLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBVSxTQUFTLENBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQy9ELEdBQUcsQ0FBQztJQUNKLEdBQUcsRUFBRSxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7Q0FDdkIsQ0FBQyxDQUFDLENBQUMsQ0FBQTtBQUVKLEdBQUcsQ0FBQyxHQUFH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